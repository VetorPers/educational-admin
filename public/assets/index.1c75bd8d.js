var e=Object.defineProperty,a=Object.defineProperties,l=Object.getOwnPropertyDescriptors,t=Object.getOwnPropertySymbols,r=Object.prototype.hasOwnProperty,o=Object.prototype.propertyIsEnumerable,s=(a,l,t)=>l in a?e(a,l,{enumerable:!0,configurable:!0,writable:!0,value:t}):a[l]=t;import{E as i,u as n,A as u,b as c,r as d,M as p,o as m,c as f,w as v,h as g,m as b,p as _,v as h,g as y,W as w,_ as C,e as k,l as x,q as O}from"./vendor.7a5fefe5.js";import{g as z,d as j}from"./index.425550fe.js";let V="/api/officialWebsite";const D=e=>i({url:V+"/addCertification",method:"post",data:e}),P=e=>i({url:V+"/updateCertification",method:"post",data:e});const q=["src"],B={key:1,class:"el-icon-plus avatar-uploader-icon"},E={class:"dialog-footer"},I={__name:"editCertification",props:{nowData:{type:Object,default:{}},dialogVisible:Boolean},emits:["close"],setup(e,{emit:a}){const l=e,t=n(),r=u(z({name:"token"})),o=u(!1),s=u(null),i=l.nowData.id?c(j(l.nowData)):c({desc:"",image_url:"",type:4,device:2}),k=()=>{s.value.validate().then((()=>{o.value=!0;(i.id?P:D)(i).then((e=>{C.success("提交成功"),o.value=!1,I("success")})).catch((()=>{C.error("提交失败"),o.value=!1}))})).catch((()=>{}))},x=(e,a)=>{i.image_url=e.data.url,C.success("上传成功！")},O=(e,a,l)=>{if(e.message&&401==JSON.parse(e.message).code)return C.warning("登录已过期，请重新登录"),void t.push("/login");C.error("上传失败")},V=()=>{I("")},I=e=>{a("close",e)};return(a,l)=>{const t=d("el-input"),n=d("el-form-item"),u=d("el-upload"),c=d("el-form"),C=d("el-button"),z=d("el-dialog"),j=p("loading");return m(),f(z,{title:w(i).id?"修改公司资质":"添加公司资质","model-value":e.dialogVisible,onClose:V,"close-on-click-modal":!1,"close-on-press-escape":!1},{footer:v((()=>[g("span",E,[b(C,{onClick:l[1]||(l[1]=e=>I("")),size:"small"},{default:v((()=>[_("取 消")])),_:1}),b(C,{type:"primary",onClick:k,size:"small"},{default:v((()=>[_("确 定")])),_:1})])])),default:v((()=>[h((m(),y("div",null,[b(c,{ref_key:"formRef",ref:s,model:w(i),"label-width":"100px"},{default:v((()=>[b(n,{prop:"desc",label:"描述:",rules:[{required:!0,message:"输入描述",trigger:"blur"}]},{default:v((()=>[b(t,{type:"text",size:"mini",modelValue:w(i).desc,"onUpdate:modelValue":l[0]||(l[0]=e=>w(i).desc=e),placeholder:"输入描述"},null,8,["modelValue"])])),_:1}),b(n,{label:"图片:",prop:"image_url",rules:[{required:!0,message:"选择图片"}]},{default:v((()=>[b(u,{class:"avatar-uploader",action:"/api/base/upload/","show-file-list":!1,"on-success":x,"on-error":O,limit:1,headers:{token:r.value,path:"/public/web_image/"}},{default:v((()=>[w(i).image_url?(m(),y("img",{key:0,style:{width:"100%",height:"100%"},src:w(i).image_url,class:"avatar"},null,8,q)):(m(),y("i",B))])),_:1},8,["headers"])])),_:1})])),_:1},8,["model"])])),[[j,o.value]])])),_:1},8,["title","model-value"])}},__scopeId:"data-v-59f8b24a"};const S={class:"btn-wrap g-flex-end"},M={class:"footer-wrap g-flex-end"},T={__name:"index",setup(e){const n=u(!1),w=u([]),z=c({total:0,size:10,current:1}),j=u(!1),D=u({});k((()=>{P()}));const P=()=>{n.value=!0;const e=(u=((e,a)=>{for(var l in a||(a={}))r.call(a,l)&&s(e,l,a[l]);if(t)for(var l of t(a))o.call(a,l)&&s(e,l,a[l]);return e})({},z),a(u,l({type:4})));var u,c;(c=e,i({url:V+"/certificationList",method:"get",params:c})).then((e=>{w.value=e.data.data,z.total=e.data.total})).catch((e=>{C.error(e.msg)})).finally((()=>{n.value=!1}))},q=()=>{D.value={},j.value=!0},B=e=>{O.confirm("确认删除？","",{confirmButtonText:"确定",cancelButtonText:"取消",closeOnClickModal:!1,closeOnPressEscape:!1}).then((()=>{n.value=!0,(e=>i({url:V+"/deleteCertification",method:"post",data:{id:e}}))(e).then((e=>{C.success("删除成功"),P()})).catch((e=>{C.error("删除失败"),n.value=!1}))}))},E=e=>{j.value=!1,"success"===e&&P()},T=e=>{z.size=e,z.current=1,P()},W=e=>{z.current=e,P()};return(e,a)=>{const l=d("el-button"),t=d("el-empty"),r=d("el-table-column"),o=d("el-image"),s=d("el-table"),i=d("el-pagination"),u=p("loading");return m(),y("div",null,[g("div",S,[b(l,{size:"small",onClick:P},{default:v((()=>[_("刷 新")])),_:1}),b(l,{type:"primary",size:"small",onClick:q},{default:v((()=>[_("添 加")])),_:1})]),h((m(),f(s,{data:w.value,border:"",style:{width:"100%"}},{empty:v((()=>[b(t,{description:"暂无数据"})])),default:v((()=>[b(r,{prop:"desc",label:"描述","min-width":"200px"}),b(r,{prop:"image_url",label:"图片"},{default:v((e=>[b(o,{style:{width:"150px",height:"210px"},src:e.row.image_url,"preview-src-list":[e.row.image_url],fit:"cover"},null,8,["src","preview-src-list"])])),_:1}),b(r,{label:"操作"},{default:v((e=>[b(l,{type:"text",onClick:a=>{return l=e.row,D.value=l,void(j.value=!0);var l}},{default:v((()=>[_("修 改")])),_:2},1032,["onClick"]),b(l,{type:"text",onClick:a=>B(e.row.id)},{default:v((()=>[_("删 除")])),_:2},1032,["onClick"])])),_:1})])),_:1},8,["data"])),[[u,n.value]]),g("div",M,[b(i,{layout:"prev, pager, next",total:z.total,"current-page":z.current,"page-size":z.size,onSizeChange:T,onCurrentChange:W},null,8,["total","current-page","page-size"])]),j.value?(m(),f(I,{key:0,nowData:D.value,dialogVisible:j.value,onClose:E},null,8,["nowData","dialogVisible"])):x("",!0)])}},__scopeId:"data-v-14b699e5"};export{T as default};
