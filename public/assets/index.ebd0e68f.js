var e=Object.defineProperty,a=Object.getOwnPropertySymbols,l=Object.prototype.hasOwnProperty,t=Object.prototype.propertyIsEnumerable,o=(a,l,t)=>l in a?e(a,l,{enumerable:!0,configurable:!0,writable:!0,value:t}):a[l]=t,r=(e,r)=>{for(var i in r||(r={}))l.call(r,i)&&o(e,i,r[i]);if(a)for(var i of a(r))t.call(r,i)&&o(e,i,r[i]);return e};import{E as i,u as n,y as d,b as s,a as u,d as p,e as c,t as m,r as f,L as b,o as g,c as h,q as y,g as v,p as C,M as V,w as _,f as j,s as O,x as k,_ as D,k as S}from"./vendor.7d420ba6.js";import{_ as w,u as z,a as U,v as x,d as I}from"./upload.24f980dd.js";import{g as N}from"./index.836b3e6c.js";const E={name:"",props:{dialogVisible:{type:Boolean,required:!0,defalut:!1},formObj:{type:Object}},components:{ElMessage:i,Upload:w},emits:["close","saveSuccess"],setup(e,a){const l=n(),t=d(!1),o=s((()=>l.state.init.phoneAppRouter)),f=u({formData:e.formObj||{name:"",picture:"",label:1,order:null,children:[]},delChild:[],targetObj:null,rules:{name:[{required:!0,message:"标题不能为空"}],picture:[{required:!0,message:"封面不能为空"}],label:[{required:!0,message:"类型不能为空"}],order:[{required:!0,message:"排序不能为空",trigger:"blur"}]}}),b=d(N({name:"token"})),g=d(null);p((()=>{})),c((()=>{}));const h=m(f);return r({appRouteList:o,formRef:g,commitForm:()=>{g.value.validate().then((()=>{t.value=!0,f.formData.v_type=2,f.formData.id?(f.formData.delChild=f.delChild,z(f.formData).then((e=>{i.success("提交成功"),a.emit("saveSuccess")})).catch((e=>{i.error("提交失败")})).finally((()=>{t.value=!1}))):U(f.formData).then((e=>{i.success("提交成功"),a.emit("saveSuccess")})).catch((e=>{i.error("提交失败")})).finally((()=>{t.value=!1}))})).catch((()=>{}))},close:()=>{a.emit("close",!1)},loading:t,token:b,upFaImg:e=>{f.formData.picture=e},upChildImg:e=>{f.targetObj.picture=e},upVideo:e=>{f.targetObj.url=e},upItem:e=>{f.targetObj=e},addVideoItem:()=>{f.formData.children.push({name:"",url:"",order:null,picture:""})},removeVideoItem:(e,a)=>{f.formData.children.splice(e,1),a.id&&f.delChild.push(a.id)}},h)}},q=(e=>(O("data-v-2b158ff1"),e=e(),k(),e))((()=>v("div",{class:"g-tips-text"},"* jpg/png格式；大小限制为2M；宽高比推荐 230:140",-1))),F={class:"g-flex-start",style:{"margin-top":"10px"}},L={class:"dialog-footer"};E.render=function(e,a,l,t,o,r){const i=f("Upload"),n=f("el-form-item"),d=f("el-input"),s=f("el-option"),u=f("el-select"),p=f("el-empty"),c=f("el-table-column"),m=f("el-button"),O=f("el-table"),k=f("el-form"),D=f("el-dialog"),S=b("loading");return g(),h(D,{title:e.formData.id?"修改视频":"添加视频","model-value":l.dialogVisible,"before-close":t.close},{footer:y((()=>[v("span",L,[C(m,{onClick:t.close,size:"small"},{default:y((()=>[V("取 消")])),_:1},8,["onClick"]),C(m,{type:"primary",onClick:t.commitForm,size:"small"},{default:y((()=>[V("确 定")])),_:1},8,["onClick"])])])),default:y((()=>[_((g(),j("div",null,[C(k,{ref:"formRef",model:e.formData,rules:e.rules,"label-width":"120px"},{default:y((()=>[C(n,{prop:"picture",label:"章节封面:"},{default:y((()=>[C(i,{type:"image",size:2,onUpSuccess:t.upFaImg,initUrl:e.formData.picture},null,8,["onUpSuccess","initUrl"]),q])),_:1}),C(n,{prop:"name",label:"章节标题:"},{default:y((()=>[C(d,{size:"mini",modelValue:e.formData.name,"onUpdate:modelValue":a[0]||(a[0]=a=>e.formData.name=a),placeholder:"输入标题",style:{width:"240px"}},null,8,["modelValue"])])),_:1}),C(n,{prop:"label",label:"类型:"},{default:y((()=>[C(u,{style:{width:"240px"},size:"mini",modelValue:e.formData.label,"onUpdate:modelValue":a[1]||(a[1]=a=>e.formData.label=a),placeholder:"请选择"},{default:y((()=>[C(s,{label:"原理",value:1}),C(s,{label:"实战",value:2})])),_:1},8,["modelValue"])])),_:1}),C(n,{prop:"order",label:"排序:"},{default:y((()=>[C(d,{style:{width:"240px"},type:"number",size:"mini",modelValue:e.formData.order,"onUpdate:modelValue":a[2]||(a[2]=a=>e.formData.order=a),placeholder:"输入顺序"},null,8,["modelValue"])])),_:1}),C(n,{prop:"children",label:"视屏列表:"},{default:y((()=>[C(O,{data:e.formData.children},{empty:y((()=>[C(p,{"image-size":100,description:"暂无数据"})])),default:y((()=>[C(c,{prop:"name",label:"标题"},{default:y((e=>[C(d,{size:"mini",modelValue:e.row.name,"onUpdate:modelValue":a=>e.row.name=a,placeholder:"输入标题"},null,8,["modelValue","onUpdate:modelValue"])])),_:1}),C(c,{prop:"picture",label:"视频封面"},{default:y((e=>[C(i,{type:"image",size:2,onUpSuccess:t.upChildImg,onClick:a=>t.upItem(e.row),initUrl:e.row.picture},null,8,["onUpSuccess","onClick","initUrl"])])),_:1}),C(c,{prop:"url",label:"视频"},{default:y((e=>[C(i,{type:"video",onUpSuccess:t.upVideo,onClick:a=>t.upItem(e.row),initUrl:e.row.url},null,8,["onUpSuccess","onClick","initUrl"])])),_:1}),C(c,{prop:"order",label:"排序"},{default:y((e=>[C(d,{type:"number",size:"mini",modelValue:e.row.order,"onUpdate:modelValue":a=>e.row.order=a,placeholder:"输入顺序"},null,8,["modelValue","onUpdate:modelValue"])])),_:1}),C(c,{label:"操作"},{default:y((e=>[C(m,{type:"text",onClick:a=>t.removeVideoItem(e.$index,e.row)},{default:y((()=>[V("移 除")])),_:2},1032,["onClick"])])),_:1})])),_:1},8,["data"]),v("div",F,[C(m,{size:"mini",type:"primary",onClick:t.addVideoItem},{default:y((()=>[V("添 加")])),_:1},8,["onClick"])])])),_:1})])),_:1},8,["model","rules"])])),[[S,t.loading]])])),_:1},8,["title","model-value","before-close"])},E.__scopeId="data-v-2b158ff1";const M={name:"bannerIndex",props:{},components:{ElMessage:i,EditVideo:E},setup(e,a){const l=u({targetObj:null,tableData:[],paginationObj:{current:1,size:10,total:0,v_type:2}}),t=d(!1),o=d(!1);function n(e){o.value=e}const s=()=>{t.value=!0,x(l.paginationObj).then((e=>{e.data.data.forEach((e=>{switch(e.logName="",e.children.forEach((a=>{e.logName+=e.order+"."+a.order+" "+a.name+"; "})),Number(e.label)){case 1:e.typeName="充型模拟";break;case 2:e.typeName="凝固模拟";break;case 3:e.typeName="充型凝固模拟"}})),l.tableData=e.data.data,l.paginationObj.total=e.data.total})).catch((e=>{i.error(e.msg)})).finally((()=>{t.value=!1}))};p((()=>{s()})),c((()=>{}));const f=m(l);return r({pageSizeChange:e=>{l.paginationObj.size=e,l.paginationObj.current=1,s()},pageCurrentChange:e=>{l.paginationObj.current=e,s()},changeDiaStatus:n,getList:s,saveSuccess:()=>{o.value=!1,s()},addVideo:()=>{l.targetObj=null,n(!0)},updateVideo:e=>{l.targetObj=JSON.parse(JSON.stringify(e)),n(!0)},deleteItem:e=>{D.confirm("确认删除？").then((()=>{t.value=!0,I(e).then((e=>{i.success("删除成功"),s()})).catch((e=>{i.error("删除失败"),t.value=!1}))}))},loading:t,dialogVisible:o},f)}},R={class:"btn-wrap g-flex-end"},P={class:"footer-wrap g-flex-end"};M.render=function(e,a,l,t,o,r){const i=f("el-button"),n=f("el-empty"),d=f("el-table-column"),s=f("el-table"),u=f("el-pagination"),p=f("EditVideo"),c=b("loading");return g(),j("div",null,[v("div",R,[C(i,{size:"small",onClick:t.getList},{default:y((()=>[V("刷 新")])),_:1},8,["onClick"]),C(i,{type:"primary",size:"small",onClick:t.addVideo},{default:y((()=>[V("添 加")])),_:1},8,["onClick"])]),_((g(),h(s,{data:e.tableData,border:"",style:{width:"100%"}},{empty:y((()=>[C(n,{description:"暂无数据"})])),default:y((()=>[C(d,{prop:"name",label:"章节名称"}),C(d,{prop:"logName",label:"章节目录"}),C(d,{prop:"typeName",label:"视频类型"}),C(d,{prop:"order",label:"排序"}),C(d,{prop:"create_time",label:"创建时间"}),C(d,{label:"操作"},{default:y((e=>[C(i,{type:"text",onClick:a=>t.updateVideo(e.row)},{default:y((()=>[V("修 改")])),_:2},1032,["onClick"]),C(i,{type:"text",onClick:a=>t.deleteItem(e.row.id)},{default:y((()=>[V("删 除")])),_:2},1032,["onClick"])])),_:1})])),_:1},8,["data"])),[[c,t.loading]]),v("div",P,[C(u,{layout:"prev, pager, next",total:e.paginationObj.total,"current-page":e.paginationObj.current,"page-size":e.paginationObj.size,onSizeChange:t.pageSizeChange,onCurrentChange:t.pageCurrentChange},null,8,["total","current-page","page-size","onSizeChange","onCurrentChange"])]),t.dialogVisible?(g(),h(p,{key:0,dialogVisible:t.dialogVisible,formObj:e.targetObj,onClose:t.changeDiaStatus,onSaveSuccess:t.saveSuccess},null,8,["dialogVisible","formObj","onClose","onSaveSuccess"])):S("",!0)])},M.__scopeId="data-v-6a2d0aa7";export{M as default};
