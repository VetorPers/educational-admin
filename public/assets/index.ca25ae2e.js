import{E as e,m as a,y as l,a as t,r as o,L as s,o as i,c as r,q as d,g as u,p as n,M as c,w as p,f as m,W as f,k as g,j as v,s as h,x as _,D as b,d as y,_ as k}from"./vendor.456c50f4.js";import{g as w,d as V}from"./index.4a156f7e.js";import{I as x,u as C}from"./base.80e9756e.js";import{Q as D}from"./vue-quill.esm-bundler.2661bb61.js";/* empty css                       */import{a as q,h as z}from"./handleFunc.6f2e466b.js";import"./quill.8d3b73ad.js";let M="/api/officialWebsite";const j=a=>e({url:M+"/addInformation",method:"post",data:a}),Y=a=>e({url:M+"/updateInformation",method:"post",data:a});const O=["src"],I={key:1,class:"el-icon-plus avatar-uploader-icon"},U=(e=>(h("data-v-7cfaaf71"),e=e(),_(),e))((()=>u("i",{class:"el-icon-plus avatar-uploader-icon"},null,-1))),E={class:"dialog-footer"},N={__name:"editInfo",props:{nowData:{type:Object,default:{}},dialogVisible:Boolean},emits:["close"],setup(e,{emit:h}){const _=e,y=a(),k=l(w({name:"token"})),M=l(!1),N=l(null),T=_.nowData.id?t(V(_.nowData)):t({title:"",desc:"",content:"",type:1,date:"",top:0,img_src:"",use_img:0,file_path:""}),B=t({title:[{required:!0,message:"请填写标题"}],desc:[{required:!0,message:"请填写文章描述"}],date:[{required:!0,message:"请填写文章日期"}],img_src:[{required:!0,message:"请选择文章头图"}]}),L=l(null),S=l([["bold","italic","underline","strike"],["blockquote","code-block"],[{header:1},{header:2}],[{list:"ordered"},{list:"bullet"}],[{script:"sub"},{script:"super"}],[{indent:"-1"},{indent:"+1"}],[{direction:"rtl"}],[{color:[]},{background:[]}],[{align:[]}],["clean"],["image","video"],[{link:e=>{if(e){var a=prompt("输入下载地址"),l=prompt("输入下载文件名称");this.quill.format("download",l),this.quill.format("link",a)}else this.quill.format("link",!1)}}]]),$=l({placeholder:"请输入文章内容...",readOnly:!1}),F=t({name:"imageUploader",module:x,options:{upload:function(e){return new Promise(((a,l)=>{C(e).then((e=>{a(e.data.data.url)})).catch((e=>{l(e)}))}))}}}),P=()=>{N.value.validate().then((()=>{M.value=!0;const e=T.id?Y:j;T.content=L.value.getContents(),T.date=(e=>{const a=new Date(e),l=a.getFullYear(),t=a.getMonth()<9?"0"+(a.getMonth()+1):a.getMonth()+1,o=a.getDate()<10?"0"+a.getDate():a.getDate();return a.getHours(),a.getMinutes(),a.getSeconds(),`${l}-${t}-${o}`})(T.date),e(T).then((e=>{b.success("提交成功"),M.value=!1,W("success")})).catch((()=>{b.error("提交失败"),M.value=!1}))})).catch((()=>{}))},R=()=>{W("")},W=e=>{h("close",e)},H=(e,a)=>{T.img_src=e.data.url,b.success("上传成功！")},J=(e,a)=>{T.file_path=e.data.url,b.success("上传成功！")},Q=(e,a,l)=>{if(e.message&&401==JSON.parse(e.message).code)return b.warning("登录已过期，请重新登录"),void y.push("/login");b.error("上传失败")};return(a,l)=>{const t=o("el-radio"),h=o("el-radio-group"),_=o("el-form-item"),b=o("el-switch"),y=o("el-input"),w=o("el-date-picker"),V=o("el-upload"),x=o("el-form"),C=o("el-button"),j=o("el-dialog"),Y=s("loading");return i(),r(j,{title:f(T).id?"修改公司资讯":"添加公司资讯","model-value":e.dialogVisible,onClose:R,"close-on-click-modal":!1,"close-on-press-escape":!1},{footer:d((()=>[u("span",E,[n(C,{onClick:l[7]||(l[7]=e=>W("")),size:"small"},{default:d((()=>[c("取 消")])),_:1}),n(C,{type:"primary",onClick:P,size:"small"},{default:d((()=>[c("确 定")])),_:1})])])),default:d((()=>[p((i(),m("div",null,[n(x,{ref_key:"formRef",ref:N,model:f(T),"label-width":"100px",rules:B},{default:d((()=>[n(_,{label:"资讯类型"},{default:d((()=>[n(h,{modelValue:f(T).type,"onUpdate:modelValue":l[0]||(l[0]=e=>f(T).type=e)},{default:d((()=>[n(t,{label:1},{default:d((()=>[c("行业动态")])),_:1}),n(t,{label:2},{default:d((()=>[c("公司动态")])),_:1})])),_:1},8,["modelValue"])])),_:1}),n(_,{prop:"use_img",label:"启用头图:"},{default:d((()=>[n(b,{modelValue:f(T).use_img,"onUpdate:modelValue":l[1]||(l[1]=e=>f(T).use_img=e),"active-value":1,"inactive-value":0},null,8,["modelValue"])])),_:1}),n(_,{prop:"title",label:"文章标题:"},{default:d((()=>[n(y,{type:"text",size:"mini",modelValue:f(T).title,"onUpdate:modelValue":l[2]||(l[2]=e=>f(T).title=e),placeholder:"输入标题"},null,8,["modelValue"])])),_:1}),n(_,{prop:"desc",label:"文章描述:"},{default:d((()=>[n(y,{type:"text",size:"mini",modelValue:f(T).desc,"onUpdate:modelValue":l[3]||(l[3]=e=>f(T).desc=e),placeholder:"输入描述"},null,8,["modelValue"])])),_:1}),n(_,{prop:"date",label:"文章日期:"},{default:d((()=>[n(w,{modelValue:f(T).date,"onUpdate:modelValue":l[4]||(l[4]=e=>f(T).date=e),type:"date",size:"mini",placeholder:"请选择日期",style:{width:"100%"},format:"YYYY-MM-DD","value-format":"YYYY-MM-DD"},null,8,["modelValue"])])),_:1}),f(T).use_img?(i(),r(_,{key:0,prop:"img_src",label:"文章头图:"},{default:d((()=>[n(V,{class:"avatar-uploader",action:"/api/base/upload/","show-file-list":!1,"on-success":H,"on-error":Q,limit:1,headers:{token:k.value,path:"/public/web_image/"}},{default:d((()=>[f(T).img_src?(i(),m("img",{key:0,style:{width:"100%",height:"100%"},src:f(T).img_src,class:"avatar"},null,8,O)):(i(),m("i",I))])),_:1},8,["headers"])])),_:1})):g("",!0),n(_,{prop:"top",label:"是否置顶:"},{default:d((()=>[n(b,{modelValue:f(T).top,"onUpdate:modelValue":l[5]||(l[5]=e=>f(T).top=e),"active-value":1,"inactive-value":0},null,8,["modelValue"])])),_:1}),n(_,{prop:"file",label:"上传要下载的文件:"},{default:d((()=>[n(V,{class:"avatar-uploader",action:"/api/base/upload/","show-file-list":!1,"on-success":J,"on-error":Q,limit:1,headers:{token:k.value,path:"/public/web_image/"}},{default:d((()=>[U])),_:1},8,["headers"])])),_:1}),f(T).file_path?(i(),r(_,{key:1,prop:"file_path",label:"文件下载地址:"},{default:d((()=>[u("div",null,v(f(T).file_path),1)])),_:1})):g("",!0),n(_,{class:"editor",prop:"article_detail",label:"文章内容:"},{default:d((()=>[n(f(D),{ref_key:"quill",ref:L,style:{height:"400px"},theme:"snow",contentType:"html",content:f(T).content,toolbar:S.value,modules:F,globalOptions:$.value,onReady:l[6]||(l[6]=e=>{return a=e,q(),a.enable(!0),void a.clipboard.addMatcher(Node.ELEMENT_NODE,z);var a})},null,8,["content","toolbar","modules","globalOptions"])])),_:1})])),_:1},8,["model","rules"])])),[[Y,M.value]])])),_:1},8,["title","model-value"])}},__scopeId:"data-v-7cfaaf71"};const T={class:"btn-wrap g-flex-end"},B={class:"footer-wrap g-flex-end"},L={__name:"index",setup(a){const f=l(!1),v=l([]),h=t({total:0,size:10,current:1}),_=l(!1),w=l({});y((()=>{V()}));const V=()=>{var a;f.value=!0,(a=h,e({url:M+"/informationList",method:"get",params:a})).then((e=>{v.value=e.data.data,h.total=e.data.total})).catch((e=>{b.error(e.msg)})).finally((()=>{f.value=!1}))},x=()=>{w.value={},_.value=!0},C=a=>{k.confirm("确认删除？","",{confirmButtonText:"确定",cancelButtonText:"取消",closeOnClickModal:!1,closeOnPressEscape:!1}).then((()=>{f.value=!0,(a=>e({url:M+"/deleteInformation",method:"post",data:{id:a}}))(a).then((e=>{b.success("删除成功"),V()})).catch((e=>{b.error("删除失败"),f.value=!1}))}))},D=e=>{_.value=!1,"success"===e&&V()},q=e=>{h.size=e,h.current=1,V()},z=e=>{h.current=e,V()};return(e,a)=>{const l=o("el-button"),t=o("el-empty"),b=o("el-table-column"),y=o("el-table"),k=o("el-pagination"),M=s("loading");return i(),m("div",null,[u("div",T,[n(l,{size:"small",onClick:V},{default:d((()=>[c("刷 新")])),_:1}),n(l,{type:"primary",size:"small",onClick:x},{default:d((()=>[c("添 加")])),_:1})]),p((i(),r(y,{data:v.value,border:"",style:{width:"100%"}},{empty:d((()=>[n(t,{description:"暂无数据"})])),default:d((()=>[n(b,{prop:"title",label:"文章标题"}),n(b,{prop:"desc",label:"文章描述"}),n(b,{label:"操作"},{default:d((e=>[n(l,{type:"text",onClick:a=>{return l=e.row,w.value=l,void(_.value=!0);var l}},{default:d((()=>[c("修 改")])),_:2},1032,["onClick"]),n(l,{type:"text",onClick:a=>C(e.row.id)},{default:d((()=>[c("删 除")])),_:2},1032,["onClick"])])),_:1})])),_:1},8,["data"])),[[M,f.value]]),u("div",B,[n(k,{layout:"prev, pager, next",total:h.total,"current-page":h.current,"page-size":h.size,onSizeChange:q,onCurrentChange:z},null,8,["total","current-page","page-size"])]),_.value?(i(),r(N,{key:0,nowData:w.value,dialogVisible:_.value,onClose:D},null,8,["nowData","dialogVisible"])):g("",!0)])}},__scopeId:"data-v-0a99499a"};export{L as default};
