var e=Object.defineProperty,l=Object.defineProperties,a=Object.getOwnPropertyDescriptors,t=Object.getOwnPropertySymbols,o=Object.prototype.hasOwnProperty,s=Object.prototype.propertyIsEnumerable,r=(l,a,t)=>a in l?e(l,a,{enumerable:!0,configurable:!0,writable:!0,value:t}):l[a]=t,i=(e,l)=>{for(var a in l||(l={}))o.call(l,a)&&r(e,a,l[a]);if(t)for(var a of t(l))s.call(l,a)&&r(e,a,l[a]);return e},n=(e,t)=>l(e,a(t));import{E as d,A as u,b as c,r as p,M as m,o as v,c as f,w as b,h as y,m as g,p as h,v as _,g as k,X as w,W as C,F as x,i as z,_ as O,l as V,e as j,q as D,k as P}from"./vendor.7a5fefe5.js";import{d as H}from"./index.9ba5c9bf.js";let S="/api/officialWebsite";const q=e=>d({url:S+"/addHistory",method:"post",data:e}),B=e=>d({url:S+"/updateHistory",method:"post",data:e});const E={class:"right-box"},I={class:"dialog-footer"},U={__name:"editHistory",props:{nowData:{type:Object,default:{}},dialogVisible:Boolean},emits:["close"],setup(e,{emit:l}){const a=e,t=u(!1),o=u(null),s=a.nowData.id?c(H(a.nowData)):c({title:"",desc:[{}],type:1,device:2}),r=()=>{o.value.validate().then((()=>{t.value=!0;(s.id?B:q)(n(i({},s),{desc:JSON.stringify(s.desc)})).then((e=>{O.success("提交成功"),t.value=!1,j("success")})).catch((()=>{O.error("提交失败"),t.value=!1}))})).catch((()=>{}))},d=()=>{j("")},j=e=>{l("close",e)},D=()=>{s.desc.push({value:""})};return(l,a)=>{const i=p("el-button"),n=p("el-input"),u=p("el-form-item"),c=p("el-form"),O=p("el-dialog"),P=m("loading");return v(),f(O,{title:C(s).id?"修改发展历程":"添加发展历程","model-value":e.dialogVisible,onClose:d,"close-on-click-modal":!1,"close-on-press-escape":!1},{footer:b((()=>[y("span",I,[g(i,{onClick:a[1]||(a[1]=e=>j("")),size:"small"},{default:b((()=>[h("取 消")])),_:1}),g(i,{type:"primary",onClick:r,size:"small"},{default:b((()=>[h("确 定")])),_:1})])])),default:b((()=>[_((v(),k("div",null,[g(c,{ref_key:"formRef",ref:o,model:C(s),"label-width":"100px"},{default:b((()=>[y("div",E,[g(i,{onClick:w(D,["prevent"]),type:"primary",size:"small"},{default:b((()=>[h("添加描述")])),_:1},8,["onClick"])]),g(u,{prop:"title",label:"标题:",rules:[{required:!0,message:"请输入标题",trigger:"blur"}]},{default:b((()=>[g(n,{type:"text",size:"mini",modelValue:C(s).title,"onUpdate:modelValue":a[0]||(a[0]=e=>C(s).title=e),placeholder:"输入标题"},null,8,["modelValue"])])),_:1}),(v(!0),k(x,null,z(C(s).desc,((e,l)=>(v(),f(u,{key:l,label:"描述"+(l+1)+":",rules:[{required:!0,message:"请输入内容",trigger:"blur"}]},{default:b((()=>[g(n,{size:"mini",modelValue:e.value,"onUpdate:modelValue":l=>e.value=l,placeholder:"请输入描述"},null,8,["modelValue","onUpdate:modelValue"]),l>0?(v(),f(i,{key:0,size:"small",onClick:w((e=>(e=>{s.desc.splice(e,1)})(l)),["prevent"])},{default:b((()=>[h("删除")])),_:2},1032,["onClick"])):V("",!0)])),_:2},1032,["label"])))),128))])),_:1},8,["model"])])),[[P,t.value]])])),_:1},8,["title","model-value"])}},__scopeId:"data-v-008695dd"};const J={class:"btn-wrap g-flex-end"},M={class:"footer-wrap g-flex-end"},N={__name:"index",setup(e){const l=u(!1),a=u([]),t=c({total:0,size:10,current:1}),o=u(!1),s=u({});j((()=>{r()}));const r=()=>{l.value=!0;const e=n(i({},t),{type:1});var o;(o=e,d({url:S+"/historyList",method:"get",params:o})).then((e=>{e.data.data.map((e=>{e.desc=JSON.parse(e.desc)})),a.value=e.data.data,t.total=e.data.total})).catch((e=>{O.error(e.msg)})).finally((()=>{l.value=!1}))},w=()=>{s.value={},o.value=!0},C=e=>{D.confirm("确认删除？","",{confirmButtonText:"确定",cancelButtonText:"取消",closeOnClickModal:!1,closeOnPressEscape:!1}).then((()=>{l.value=!0,(e=>d({url:S+"/deleteHistory",method:"post",data:{id:e}}))(e).then((e=>{O.success("删除成功"),r()})).catch((e=>{O.error("删除失败"),l.value=!1}))}))},H=e=>{o.value=!1,"success"===e&&r()},q=e=>{t.size=e,t.current=1,r()},B=e=>{t.current=e,r()};return(e,i)=>{const n=p("el-button"),d=p("el-empty"),u=p("el-table-column"),c=p("el-table"),O=p("el-pagination"),j=m("loading");return v(),k("div",null,[y("div",J,[g(n,{size:"small",onClick:r},{default:b((()=>[h("刷 新")])),_:1}),g(n,{type:"primary",size:"small",onClick:w},{default:b((()=>[h("添 加")])),_:1})]),_((v(),f(c,{data:a.value,border:"",style:{width:"100%"}},{empty:b((()=>[g(d,{description:"暂无数据"})])),default:b((()=>[g(u,{prop:"title",label:"标题","min-width":"200px"}),g(u,{prop:"desc",label:"描述","min-width":"450px"},{default:b((e=>[(v(!0),k(x,null,z(e.row.desc,(e=>(v(),k("div",{key:e.value},P(e.value),1)))),128))])),_:1}),g(u,{label:"操作"},{default:b((e=>[g(n,{type:"text",onClick:l=>{return a=e.row,s.value=a,void(o.value=!0);var a}},{default:b((()=>[h("修 改")])),_:2},1032,["onClick"]),g(n,{type:"text",onClick:l=>C(e.row.id)},{default:b((()=>[h("删 除")])),_:2},1032,["onClick"])])),_:1})])),_:1},8,["data"])),[[j,l.value]]),y("div",M,[g(O,{layout:"prev, pager, next",total:t.total,"current-page":t.current,"page-size":t.size,onSizeChange:q,onCurrentChange:B},null,8,["total","current-page","page-size"])]),o.value?(v(),f(U,{key:0,nowData:s.value,dialogVisible:o.value,onClose:H},null,8,["nowData","dialogVisible"])):V("",!0)])}},__scopeId:"data-v-e8660e42"};export{N as default};
